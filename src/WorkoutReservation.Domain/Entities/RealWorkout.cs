using WorkoutReservation.Domain.Abstractions;
using WorkoutReservation.Domain.Exceptions;

namespace WorkoutReservation.Domain.Entities;

public class RealWorkout : BaseWorkout
{
    public DateOnly Date { get; set; }
    public int CurrentParticipantNumber { get; set; }
    public bool IsAutoGenerated { get; set; }
    public ICollection<Reservation> Reservations { get; set; } = new List<Reservation>();
    
    public RealWorkout()
    {
    }
    
    public RealWorkout(int maxParticipantNumber, TimeOnly startTime, TimeOnly endTime, 
        WorkoutType workoutType, Instructor instructor, DateOnly date, ApplicationUser currentUser) 
        : base(maxParticipantNumber, startTime, endTime, workoutType, instructor)
    {
        Date = date;
        CurrentParticipantNumber = 0;
        IsAutoGenerated = false;
        CreatedDate = DateTime.Now;
        CreatedBy = currentUser.Id.ToString();
    }

    public void IncrementCurrentParticipantNumber()
    {
        if (CurrentParticipantNumber > MaxParticipantNumber)
        {
            throw new DomainException("CurrentParticipantNumber cannot be greater than MaxParticipantNumber");
        }
        
        CurrentParticipantNumber++;
    }
    
    public void DecrementCurrentParticipantNumber()
    {
        if (CurrentParticipantNumber > 0)
        {
            CurrentParticipantNumber--;
        }
    }
}
